#细说单例
------
######什么是单例模式
>[单例模式](http://zh.wikipedia.org/wiki/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F)，也叫单子模式，是一种常用的软件设计模式。在应用这个模式时，单例对象的类必须保证只有一个实例存在。

中心原则就是：**单例对象的类必须保证只有一个实例存在**

在java中主要有两种构建方式
* 懒汉方式。指全局的单例实例在第一次被使用时构建。
* 饿汉方式。指全局的单例实例在类装载时构建。

简单的说就是一个需要*延迟初始化*，一个则不需要。

比较简单的构建方式有：

    public class Singleton {
        private final static Singleton INSTANCE = new Singleton();

        // Private constructor suppresses   
        private Singleton() {
        }

        // default public constructor
        public static Singleton getInstance() {
            return INSTANCE;
        }
    }

这种方式实现简单，实例在类装载时构建，如果想要实现一种实例在第一次被使用时构建应该怎么做？

有一种叫做*双重检查锁(double-checked locking)*

    public class Singleton {
        private static volatile Singleton INSTANCE = null;

        // Private constructor suppresses 
        // default public constructor
        private Singleton() {
        }

        //thread safe and performance  promote 
        public static Singleton getInstance() {
            if (INSTANCE == null) {
                synchronized (Singleton.class) {
                    //when more than two threads run into the first null check same time, to avoid instanced more than one time, it needs to be checked again.
                    if (INSTANCE == null) {
                        INSTANCE = new Singleton();
                    }
                }
            }
            return INSTANCE;
        }
    }

此种方法只能用在JDK5及以后版本(注意 INSTANCE 被声明为 volatile)，之前的版本使用“双重检查锁”会发生非预期行为
